"use strict";

function ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); enumerableOnly && (symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; })), keys.push.apply(keys, symbols); } return keys; }
function _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = null != arguments[i] ? arguments[i] : {}; i % 2 ? ownKeys(Object(source), !0).forEach(function (key) { _defineProperty(target, key, source[key]); }) : Object.getOwnPropertyDescriptors ? Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)) : ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } return target; }
function _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }
// Slider
var prizesLeftArrow = document.querySelector('.controls-left'),
  prizesRightArrow = document.querySelector('.controls-right');

//counter slide on media 890
var allSlides = document.querySelector('.all-slide');
var counterSlide = document.querySelector('.active-slide');
var count = 1;

//buttons slider

var buttonLeft = document.querySelector('.controls-slider-left');
var buttonRight = document.querySelector('.controls-slider-right');
buttonLeft.onmouseover = function () {
  var but = document.querySelector('.controls-left');
  but.classList.add('onmouse');
};
buttonLeft.onmouseout = function () {
  var but = document.querySelector('.controls-left');
  but.classList.remove('onmouse');
};
buttonRight.onmouseover = function () {
  var but = document.querySelector('.controls-right');
  but.classList.add('onmouse');
};
buttonRight.onmouseout = function () {
  var but = document.querySelector('.controls-right');
  but.classList.remove('onmouse');
};
var slider1 = slider('tasks-slider', '.tasks__slider-item', prizesLeftArrow, prizesRightArrow, false);
function slider(id, itemSelector, leftArrow, rightArrow, autoplay, config) {
  var AUTOPLAY_INTERVAL = 50000;
  var el = document.getElementById(id);
  el.classList.add('slider');
  var mediaStep = '';
  var activeIndIndex = 0;
  var toogleIndex = 0;
  var items = el.querySelectorAll(itemSelector);
  var timerId;
  function allSlide() {
    allSlides.innerHTML = items.length;
  }
  allSlide();
  function getMediaStep() {
    var width = window.innerWidth;
    var newStep = width > (obj.config.media && obj.config.media.lg) ? 'lg' : width > (obj.config.media && obj.config.media.md) ? 'md' : width > (obj.config.media && obj.config.media.sm) ? 'sm' : 'xs';
    if (mediaStep !== newStep) {
      mediaStep = newStep;
      obj.buildSlider();
    }
  }
  function getItemsQuantity() {
    return obj.config.elemsPerPage[mediaStep];
  }
  function onResize() {
    getMediaStep();
  }
  var obj = {
    activeIndex: 0,
    activeIndIndex: activeIndIndex > 0 ? activeIndIndex : 0,
    toggleIndex: 0,
    init: function init() {
      getMediaStep();
      var startX = 0;
      var touched = false;
      var inner = el.querySelector('.slider-inner');
      var indicators = el.querySelectorAll('.slider-indicator');
      function onMouseDown(e) {
        startX = e.clientX || e.touches[0].clientX;
        touched = true;
        var weekly = document.querySelectorAll('.result__weeks-btn');
        // for (const item of weekly) item.addEventListener('touchstart', selectWeek);
      }

      function onMouseMove(e) {
        e.preventDefault();
        if (touched) {
          inner = inner || el.querySelector('.slider-inner');
          var x = e.clientX || e.touches[0].clientX;
          var diff = x - startX;
          if (diff < 0 && activeIndIndex < indicators.length - 1 || diff > 0 && activeIndIndex > 0) {
            inner.style.transform = 'translateX(' + diff + 'px)';
          }
        }
      }
      function onMouseEnd(e) {
        if (touched) {
          var x = e.clientX || e.changedTouches[0].clientX;
          if (x - startX > 30) {
            toggleIndex(activeIndIndex - 1);
            count--;
            counterSlide.innerHTML = count;
          } else if (startX - x > 30) {
            toggleIndex(activeIndIndex + 1);
            count++;
            counterSlide.innerHTML = count;
          }
          inner = inner || el.querySelector('.slider-inner');
          inner.style.transform = '';
        }
        touched = false;
        if (activeIndIndex === 0) {
          count = 1;
          counterSlide.innerHTML = count;
        }
        if (activeIndIndex === items.length - 1) {
          count = items.length;
          counterSlide.innerHTML = count;
        }
      }
      rightArrow.addEventListener('click', function () {
        toggleIndex(activeIndIndex + 1);
        console.log(activeIndIndex);
        //obj.next()
        count++;
        counterSlide.innerHTML = count;
      });
      leftArrow.addEventListener('click', function () {
        toggleIndex(activeIndIndex - 1);
        console.log(activeIndIndex);
        //obj.prev()
        count--;
        counterSlide.innerHTML = count;
      });
      window.removeEventListener('resize', onResize);
      window.addEventListener('resize', onResize);
      el.removeEventListener('mousedown', onMouseDown);
      el.removeEventListener('touchstart', onMouseDown);
      el.addEventListener('mousedown', onMouseDown);
      el.addEventListener('touchstart', onMouseDown);
      el.removeEventListener('mousemove', onMouseMove);
      el.removeEventListener('touchmove', onMouseMove);
      el.addEventListener('mousemove', onMouseMove);
      // el.addEventListener('touchmove', onMouseMove);
      window.removeEventListener('mouseup', onMouseEnd);
      window.removeEventListener('touchend', onMouseEnd);
      window.addEventListener('mouseup', onMouseEnd);
      window.addEventListener('touchend', onMouseEnd);
      if (autoplay) {
        timerId = setInterval(function () {
          return toggleIndex((activeIndIndex + 1) % indicators.length);
        }, AUTOPLAY_INTERVAL);
      }
      return obj;
    },
    config: {
      elemsPerPage: _objectSpread(_objectSpread({}, {
        'lg': 1,
        'md': 1,
        'sm': 1,
        'xs': 1
      }), config && config.elemsPerPage || {}),
      media: _objectSpread(_objectSpread({}, {
        'lg': 1160,
        'md': 920,
        'sm': 700
      }), config && config.media || {})
    },
    buildSlider: function buildSlider() {
      obj.removeSlider();
      var wrapper = document.createElement("div");
      wrapper.className = 'slider-wrapper';
      var inner = document.createElement("div");
      inner.className = 'slider-inner';
      wrapper.appendChild(inner);
      el.appendChild(wrapper);
      if (obj.config.elemsPerPage[mediaStep] >= items.length + 1) {
        el.classList.add('not-enough-elems');
        return;
      }
      buildPages();
    },
    //     getMediaStep() {
    //     // var width = window.innerWidth;
    //     // var newStep = width > mediaConfig && mediaConfig.lg !== undefined ? mediaConfig.lg : 1150 ? 'lg'
    //     //     : width > (mediaConfig && mediaConfig.md !== undefined ? mediaConfig.md : 767) ? 'md'
    //     //         : width > (mediaConfig && mediaConfig.sm !== undefined ? mediaConfig.sm : 600) ? 'sm' : 'xs';
    //
    //     if (mediaStep !== newStep) {
    //         mediaStep = newStep;
    //         obj.buildSlider();
    //     }
    // },
    removeSlider: function removeSlider() {
      var wrapper = el.querySelector('.slider-wrapper');
      el.classList.remove('not-enough-elems');
      wrapper && wrapper.remove();
      if (timerId) {
        clearInterval(timerId);
      }
    },
    toggle: toggleIndex
  };
  function buildIndicators() {
    var prevInd = el.querySelector('.slider-indicators');
    prevInd && prevInd.remove();
    var indicators = document.createElement('div');
    indicators.classList.add('slider-indicators');
    var _loop = function _loop(i) {
      var indicator = document.createElement('div');
      indicator.classList.add('slider-indicator');
      if (i === activeIndIndex) {
        indicator.classList.add('active');
      }
      indicator.setAttribute('index', i);
      indicator.addEventListener('click', function () {
        toggleIndex(i);
      });
      indicators.appendChild(indicator);
    };
    for (var i = 0; i < Math.ceil(items.length / getItemsQuantity()); i++) {
      _loop(i);
    }
    var wrapper = el.querySelector('.slider-wrapper');
    wrapper.appendChild(indicators);
  }
  function buildPages(step) {
    step = step || 1;
    var pagePrev = buildPage(obj.activeIndex + items.length - getItemsQuantity() * step);
    var pageCurrent = buildPage(obj.activeIndex);
    var pageNext = buildPage(obj.activeIndex + getItemsQuantity() * step);
    var inner = el.querySelector('.slider-inner');
    if (getItemsQuantity() < items.length) {
      buildIndicators();
      if (!el.querySelector('.slider-indicator.active')) {
        // toggleIndex(0);
      }
    }
    inner.innerHTML = '';
    inner.appendChild(pagePrev);
    inner.appendChild(pageCurrent);
    inner.appendChild(pageNext);
  }
  function buildPage(index) {
    var page = document.createElement("div");
    page.classList.add('slider-page');
    for (var i = index; i < index + getItemsQuantity(); i++) {
      var item = items[i % items.length];
      var newItem = item.cloneNode(true);
      page.appendChild(newItem);
    }
    return page;
  }
  function toggleIndex(index) {
    var indActive = el.querySelector('.slider-indicator.active');
    var indicators = el.querySelectorAll('.slider-indicator');
    if (!indicators[index]) {
      return;
    }
    leftArrow.classList.remove('arrow-disabled');
    rightArrow.classList.remove('arrow-disabled');
    if (index === 0) {
      leftArrow.classList.add('arrow-disabled');
    }
    if (index === indicators.length - 1) {
      rightArrow.classList.add('arrow-disabled');
    }
    indActive && indActive.classList.remove('active');
    indicators[index] && indicators[index].classList.add('active');
    if (index > activeIndIndex) {
      index - activeIndIndex > 1 && buildPages(index - activeIndIndex);
      obj.next();
    } else if (index < activeIndIndex) {
      activeIndIndex - index > 1 && buildPages(activeIndIndex - index);
      obj.prev();
    }
    activeIndIndex = index;
    // document.querySelector('.current').textContent = activeIndIndex + 1;
  }

  obj.prev = function () {
    var wrapper = el.querySelector('.slider-wrapper');
    wrapper.classList.add('prev');
    setTimeout(function () {
      wrapper.classList.remove('prev');
      obj.activeIndex = (obj.activeIndex - getItemsQuantity() + items.length) % items.length;
      buildPages();
    }, 300);
  };
  obj.next = function () {
    var wrapper = el.querySelector('.slider-wrapper');
    wrapper.classList.add('next');
    setTimeout(function () {
      wrapper.classList.remove('next');
      obj.activeIndex = (obj.activeIndex + getItemsQuantity() + items.length) % items.length;
      buildPages();
    }, 300);
  };
  return obj.init();
}
"use strict";
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm1haW4uanMiLCJzZWNvbmQuanMiXSwibmFtZXMiOlsicHJpemVzTGVmdEFycm93IiwiZG9jdW1lbnQiLCJxdWVyeVNlbGVjdG9yIiwicHJpemVzUmlnaHRBcnJvdyIsImFsbFNsaWRlcyIsImNvdW50ZXJTbGlkZSIsImNvdW50IiwiYnV0dG9uTGVmdCIsImJ1dHRvblJpZ2h0Iiwib25tb3VzZW92ZXIiLCJidXQiLCJjbGFzc0xpc3QiLCJhZGQiLCJvbm1vdXNlb3V0IiwicmVtb3ZlIiwic2xpZGVyMSIsInNsaWRlciIsImlkIiwiaXRlbVNlbGVjdG9yIiwibGVmdEFycm93IiwicmlnaHRBcnJvdyIsImF1dG9wbGF5IiwiY29uZmlnIiwiQVVUT1BMQVlfSU5URVJWQUwiLCJlbCIsImdldEVsZW1lbnRCeUlkIiwibWVkaWFTdGVwIiwiYWN0aXZlSW5kSW5kZXgiLCJ0b29nbGVJbmRleCIsIml0ZW1zIiwicXVlcnlTZWxlY3RvckFsbCIsInRpbWVySWQiLCJhbGxTbGlkZSIsImlubmVySFRNTCIsImxlbmd0aCIsImdldE1lZGlhU3RlcCIsIndpZHRoIiwid2luZG93IiwiaW5uZXJXaWR0aCIsIm5ld1N0ZXAiLCJvYmoiLCJtZWRpYSIsImxnIiwibWQiLCJzbSIsImJ1aWxkU2xpZGVyIiwiZ2V0SXRlbXNRdWFudGl0eSIsImVsZW1zUGVyUGFnZSIsIm9uUmVzaXplIiwiYWN0aXZlSW5kZXgiLCJ0b2dnbGVJbmRleCIsImluaXQiLCJzdGFydFgiLCJ0b3VjaGVkIiwiaW5uZXIiLCJpbmRpY2F0b3JzIiwib25Nb3VzZURvd24iLCJlIiwiY2xpZW50WCIsInRvdWNoZXMiLCJ3ZWVrbHkiLCJvbk1vdXNlTW92ZSIsInByZXZlbnREZWZhdWx0IiwieCIsImRpZmYiLCJzdHlsZSIsInRyYW5zZm9ybSIsIm9uTW91c2VFbmQiLCJjaGFuZ2VkVG91Y2hlcyIsImFkZEV2ZW50TGlzdGVuZXIiLCJjb25zb2xlIiwibG9nIiwicmVtb3ZlRXZlbnRMaXN0ZW5lciIsInNldEludGVydmFsIiwicmVtb3ZlU2xpZGVyIiwid3JhcHBlciIsImNyZWF0ZUVsZW1lbnQiLCJjbGFzc05hbWUiLCJhcHBlbmRDaGlsZCIsImJ1aWxkUGFnZXMiLCJjbGVhckludGVydmFsIiwidG9nZ2xlIiwiYnVpbGRJbmRpY2F0b3JzIiwicHJldkluZCIsImkiLCJpbmRpY2F0b3IiLCJzZXRBdHRyaWJ1dGUiLCJNYXRoIiwiY2VpbCIsInN0ZXAiLCJwYWdlUHJldiIsImJ1aWxkUGFnZSIsInBhZ2VDdXJyZW50IiwicGFnZU5leHQiLCJpbmRleCIsInBhZ2UiLCJpdGVtIiwibmV3SXRlbSIsImNsb25lTm9kZSIsImluZEFjdGl2ZSIsIm5leHQiLCJwcmV2Iiwic2V0VGltZW91dCJdLCJtYXBwaW5ncyI6Ijs7Ozs7QUFBQTtBQUNBLElBQUlBLGVBQWUsR0FBR0MsUUFBUSxDQUFDQyxhQUFhLENBQUMsZ0JBQWdCLENBQUM7RUFDMURDLGdCQUFnQixHQUFHRixRQUFRLENBQUNDLGFBQWEsQ0FBQyxpQkFBaUIsQ0FBQzs7QUFFaEU7QUFDQSxJQUFNRSxTQUFTLEdBQUdILFFBQVEsQ0FBQ0MsYUFBYSxDQUFDLFlBQVksQ0FBQztBQUN0RCxJQUFNRyxZQUFZLEdBQUdKLFFBQVEsQ0FBQ0MsYUFBYSxDQUFDLGVBQWUsQ0FBQztBQUM1RCxJQUFJSSxLQUFLLEdBQUcsQ0FBQzs7QUFFYjs7QUFFQSxJQUFNQyxVQUFVLEdBQUdOLFFBQVEsQ0FBQ0MsYUFBYSxDQUFDLHVCQUF1QixDQUFDO0FBQ2xFLElBQU1NLFdBQVcsR0FBR1AsUUFBUSxDQUFDQyxhQUFhLENBQUMsd0JBQXdCLENBQUM7QUFFcEVLLFVBQVUsQ0FBQ0UsV0FBVyxHQUFHLFlBQVk7RUFDakMsSUFBSUMsR0FBRyxHQUFHVCxRQUFRLENBQUNDLGFBQWEsQ0FBQyxnQkFBZ0IsQ0FBQztFQUNsRFEsR0FBRyxDQUFDQyxTQUFTLENBQUNDLEdBQUcsQ0FBQyxTQUFTLENBQUM7QUFDaEMsQ0FBQztBQUNETCxVQUFVLENBQUNNLFVBQVUsR0FBRyxZQUFZO0VBQ2hD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TUFDbkIzQixPQUFPLENBQUNoRSxTQUFTLENBQUNHLE1BQU0sQ0FBQyxNQUFNLENBQUM7TUFDaEMwQixHQUFHLENBQUNTLFdBQVcsR0FBRyxDQUFDVCxHQUFHLENBQUNTLFdBQVcsR0FBR0gsZ0JBQWdCLEVBQUUsR0FBR2pCLEtBQUssQ0FBQ0ssTUFBTSxJQUFJTCxLQUFLLENBQUNLLE1BQU07TUFDdEY2QyxVQUFVLEVBQUU7SUFDaEIsQ0FBQyxFQUFFLEdBQUcsQ0FBQztFQUNYLENBQUM7RUFFRHZDLEdBQUcsQ0FBQzRELElBQUksR0FBRyxZQUFZO0lBQ25CLElBQUl6QixPQUFPLEdBQUduRCxFQUFFLENBQUN0QixhQUFhLENBQUMsaUJBQWlCLENBQUM7SUFDakR5RSxPQUFPLENBQUNoRSxTQUFTLENBQUNDLEdBQUcsQ0FBQyxNQUFNLENBQUM7SUFDN0IwRixVQUFVLENBQUMsWUFBWTtNQUNuQjNCLE9BQU8sQ0FBQ2hFLFNBQVMsQ0FBQ0csTUFBTSxDQUFDLE1BQU0sQ0FBQztNQUNoQzBCLEdBQUcsQ0FBQ1MsV0FBVyxHQUFHLENBQUNULEdBQUcsQ0FBQ1MsV0FBVyxHQUFHSCxnQkFBZ0IsRUFBRSxHQUFHakIsS0FBSyxDQUFDSyxNQUFNLElBQUlMLEtBQUssQ0FBQ0ssTUFBTTtNQUN0RjZDLFVBQVUsRUFBRTtJQUNoQixDQUFDLEVBQUUsR0FBRyxDQUFDO0VBQ1gsQ0FBQztFQUNELE9BQU92QyxHQUFHLENBQUNXLElBQUksRUFBRTtBQUNyQjtBQ3JWQSIsImZpbGUiOiJtYWluLmpzIiwic291cmNlc0NvbnRlbnQiOlsiLy8gU2xpZGVyXG5sZXQgcHJpemVzTGVmdEFycm93ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmNvbnRyb2xzLWxlZnQnKSxcbiAgICBwcml6ZXNSaWdodEFycm93ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmNvbnRyb2xzLXJpZ2h0Jyk7XG5cbi8vY291bnRlciBzbGlkZSBvbiBtZWRpYSA4OTBcbmNvbnN0IGFsbFNsaWRlcyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5hbGwtc2xpZGUnKVxuY29uc3QgY291bnRlclNsaWRlID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmFjdGl2ZS1zbGlkZScpXG5sZXQgY291bnQgPSAxO1xuXG4vL2J1dHRvbnMgc2xpZGVyXG5cbmNvbnN0IGJ1dHRvbkxlZnQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuY29udHJvbHMtc2xpZGVyLWxlZnQnKTtcbmNvbnN0IGJ1dHRvblJpZ2h0ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmNvbnRyb2xzLXNsaWRlci1yaWdodCcpO1xuXG5idXR0b25MZWZ0Lm9ubW91c2VvdmVyID0gZnVuY3Rpb24gKCkge1xuICAgIGxldCBidXQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuY29udHJvbHMtbGVmdCcpO1xuICAgIGJ1dC5jbGFzc0xpc3QuYWRkKCdvbm1vdXNlJylcbn07XG5idXR0b25MZWZ0Lm9ubW91c2VvdXQgPSBmdW5jdGlvbiAoKSB7XG4gICAgbGV0IGJ1dCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5jb250cm9scy1sZWZ0Jyk7XG4gICAgYnV0LmNsYXNzTGlzdC5yZW1vdmUoJ29ubW91c2UnKVxufTtcblxuYnV0dG9uUmlnaHQub25tb3VzZW92ZXIgPSBmdW5jdGlvbiAoKSB7XG4gICAgbGV0IGJ1dCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5jb250cm9scy1yaWdodCcpO1xuICAgIGJ1dC5jbGFzc0xpc3QuYWRkKCdvbm1vdXNlJylcbn07XG5idXR0b25SaWdodC5vbm1vdXNlb3V0ID0gZnVuY3Rpb24gKCkge1xuICAgIGxldCBidXQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuY29udHJvbHMtcmlnaHQnKTtcbiAgICBidXQuY2xhc3NMaXN0LnJlbW92ZSgnb25tb3VzZScpXG59O1xuXG52YXIgc2xpZGVyMSA9IHNsaWRlcihcbiAgICAndGFza3Mtc2xpZGVyJyxcbiAgICAnLnRhc2tzX19zbGlkZXItaXRlbScsXG4gICAgcHJpemVzTGVmdEFycm93LCBwcml6ZXNSaWdodEFycm93LCBmYWxzZSk7XG5cbmZ1bmN0aW9uIHNsaWRlcihpZCwgaXRlbVNlbGVjdG9yLCBsZWZ0QXJyb3csIHJpZ2h0QXJyb3csIGF1dG9wbGF5LCBjb25maWcpIHtcbiAgICBjb25zdCBBVVRPUExBWV9JTlRFUlZBTCA9IDUwMDAwO1xuXG5cbiAgICB2YXIgZWwgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChpZCk7XG4gICAgZWwuY2xhc3NMaXN0LmFkZCgnc2xpZGVyJylcbiAgICB2YXIgbWVkaWFTdGVwID0gJyc7XG4gICAgdmFyIGFjdGl2ZUluZEluZGV4ID0gMDtcbiAgICB2YXIgdG9vZ2xlSW5kZXggPSAwO1xuICAgIHZhciBpdGVtcyA9IGVsLnF1ZXJ5U2VsZWN0b3JBbGwoaXRlbVNlbGVjdG9yKTtcbiAgICB2YXIgdGltZXJJZDtcblxuICAgIGZ1bmN0aW9uIGFsbFNsaWRlKCkge1xuICAgICAgICBhbGxTbGlkZXMuaW5uZXJIVE1MID0gaXRlbXMubGVuZ3RoO1xuICAgIH1cblxuICAgIGFsbFNsaWRlKClcblxuICAgIGZ1bmN0aW9uIGdldE1lZGlhU3RlcCgpIHtcbiAgICAgICAgdmFyIHdpZHRoID0gd2luZG93LmlubmVyV2lkdGg7XG4gICAgICAgIHZhciBuZXdTdGVwID0gd2lkdGggPiAob2JqLmNvbmZpZy5tZWRpYSAmJiBvYmouY29uZmlnLm1lZGlhLmxnKSA/ICdsZydcbiAgICAgICAgICAgIDogd2lkdGggPiAob2JqLmNvbmZpZy5tZWRpYSAmJiBvYmouY29uZmlnLm1lZGlhLm1kKSA/ICdtZCdcbiAgICAgICAgICAgICAgICA6IHdpZHRoID4gKG9iai5jb25maWcubWVkaWEgJiYgb2JqLmNvbmZpZy5tZWRpYS5zbSkgPyAnc20nIDogJ3hzJztcblxuICAgICAgICBpZiAobWVkaWFTdGVwICE9PSBuZXdTdGVwKSB7XG4gICAgICAgICAgICBtZWRpYVN0ZXAgPSBuZXdTdGVwO1xuICAgICAgICAgICAgb2JqLmJ1aWxkU2xpZGVyKCk7XG4gICAgICAgIH1cbiAgICB9XG5cblxuICAgIGZ1bmN0aW9uIGdldEl0ZW1zUXVhbnRpdHkoKSB7XG4gICAgICAgIHJldHVybiBvYmouY29uZmlnLmVsZW1zUGVyUGFnZVttZWRpYVN0ZXBdXG4gICAgfVxuXG4gICAgZnVuY3Rpb24gb25SZXNpemUoKSB7XG4gICAgICAgIGdldE1lZGlhU3RlcCgpXG4gICAgfVxuXG4gICAgdmFyIG9iaiA9IHtcbiAgICAgICAgYWN0aXZlSW5kZXg6IDAsXG4gICAgICAgIGFjdGl2ZUluZEluZGV4OiBhY3RpdmVJbmRJbmRleCA+IDAgPyBhY3RpdmVJbmRJbmRleCA6IDAsXG4gICAgICAgIHRvZ2dsZUluZGV4OiAwLFxuICAgICAgICBpbml0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICBnZXRNZWRpYVN0ZXAoKTtcblxuICAgICAgICAgICAgdmFyIHN0YXJ0WCA9IDBcbiAgICAgICAgICAgIHZhciB0b3VjaGVkID0gZmFsc2VcblxuICAgICAgICAgICAgdmFyIGlubmVyID0gZWwucXVlcnlTZWxlY3RvcignLnNsaWRlci1pbm5lcicpO1xuICAgICAgICAgICAgdmFyIGluZGljYXRvcnMgPSBlbC5xdWVyeVNlbGVjdG9yQWxsKCcuc2xpZGVyLWluZGljYXRvcicpO1xuXG4gICAgICAgICAgICBmdW5jdGlvbiBvbk1vdXNlRG93bihlKSB7XG4gICAgICAgICAgICAgICAgc3RhcnRYID0gZS5jbGllbnRYIHx8IGUudG91Y2hlc1swXS5jbGllbnRYO1xuICAgICAgICAgICAgICAgIHRvdWNoZWQgPSB0cnVlO1xuICAgICAgICAgICAgICAgIGNvbnN0IHdlZWtseSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJy5yZXN1bHRfX3dlZWtzLWJ0bicpO1xuICAgICAgICAgICAgICAgIC8vIGZvciAoY29uc3QgaXRlbSBvZiB3ZWVrbHkpIGl0ZW0uYWRkRXZlbnRMaXN0ZW5lcigndG91Y2hzdGFydCcsIHNlbGVjdFdlZWspO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBmdW5jdGlvbiBvbk1vdXNlTW92ZShlKSB7XG4gICAgICAgICAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpXG4gICAgICAgICAgICAgICAgaWYgKHRvdWNoZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgaW5uZXIgPSBpbm5lciB8fCBlbC5xdWVyeVNlbGVjdG9yKCcuc2xpZGVyLWlubmVyJylcbiAgICAgICAgICAgICAgICAgICAgdmFyIHggPSBlLmNsaWVudFggfHwgZS50b3VjaGVzWzBdLmNsaWVudFg7XG4gICAgICAgICAgICAgICAgICAgIHZhciBkaWZmID0geCAtIHN0YXJ0WDtcbiAgICAgICAgICAgICAgICAgICAgaWYgKChkaWZmIDwgMCAmJiBhY3RpdmVJbmRJbmRleCA8IGluZGljYXRvcnMubGVuZ3RoIC0gMSkgfHwgKGRpZmYgPiAwICYmIGFjdGl2ZUluZEluZGV4ID4gMCkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlubmVyLnN0eWxlLnRyYW5zZm9ybSA9ICd0cmFuc2xhdGVYKCcgKyBkaWZmICsgJ3B4KSdcbiAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBmdW5jdGlvbiBvbk1vdXNlRW5kKGUpIHtcbiAgICAgICAgICAgICAgICBpZiAodG91Y2hlZCkge1xuICAgICAgICAgICAgICAgICAgICB2YXIgeCA9IGUuY2xpZW50WCB8fCBlLmNoYW5nZWRUb3VjaGVzWzBdLmNsaWVudFg7XG5cbiAgICAgICAgICAgICAgICAgICAgaWYgKHggLSBzdGFydFggPiAzMCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdG9nZ2xlSW5kZXgoYWN0aXZlSW5kSW5kZXggLSAxKVxuICAgICAgICAgICAgICAgICAgICAgICAgY291bnQtLVxuICAgICAgICAgICAgICAgICAgICAgICAgY291bnRlclNsaWRlLmlubmVySFRNTCA9IGNvdW50O1xuXG5cbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmIChzdGFydFggLSB4ID4gMzApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRvZ2dsZUluZGV4KGFjdGl2ZUluZEluZGV4ICsgMSlcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvdW50KytcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvdW50ZXJTbGlkZS5pbm5lckhUTUwgPSBjb3VudDtcblxuICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgaW5uZXIgPSBpbm5lciB8fCBlbC5xdWVyeVNlbGVjdG9yKCcuc2xpZGVyLWlubmVyJylcbiAgICAgICAgICAgICAgICAgICAgaW5uZXIuc3R5bGUudHJhbnNmb3JtID0gJydcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgdG91Y2hlZCA9IGZhbHNlXG4gICAgICAgICAgICAgICAgaWYgKGFjdGl2ZUluZEluZGV4ID09PSAwKSB7XG4gICAgICAgICAgICAgICAgICAgIGNvdW50ID0gMVxuICAgICAgICAgICAgICAgICAgICBjb3VudGVyU2xpZGUuaW5uZXJIVE1MID0gY291bnQ7XG5cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgaWYgKGFjdGl2ZUluZEluZGV4ID09PSBpdGVtcy5sZW5ndGggLSAxKSB7XG4gICAgICAgICAgICAgICAgICAgIGNvdW50ID0gaXRlbXMubGVuZ3RoO1xuICAgICAgICAgICAgICAgICAgICBjb3VudGVyU2xpZGUuaW5uZXJIVE1MID0gY291bnQ7XG5cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHJpZ2h0QXJyb3cuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoKSA9PiB7XG4gICAgICAgICAgICAgICAgdG9nZ2xlSW5kZXgoYWN0aXZlSW5kSW5kZXggKyAxKVxuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKGFjdGl2ZUluZEluZGV4KVxuICAgICAgICAgICAgICAgIC8vb2JqLm5leHQoKVxuICAgICAgICAgICAgICAgIGNvdW50KytcbiAgICAgICAgICAgICAgICBjb3VudGVyU2xpZGUuaW5uZXJIVE1MID0gY291bnQ7XG5cbiAgICAgICAgICAgIH0pXG5cbiAgICAgICAgICAgIGxlZnRBcnJvdy5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpID0+IHtcbiAgICAgICAgICAgICAgICB0b2dnbGVJbmRleChhY3RpdmVJbmRJbmRleCAtIDEpXG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2coYWN0aXZlSW5kSW5kZXgpXG4gICAgICAgICAgICAgICAgLy9vYmoucHJldigpXG4gICAgICAgICAgICAgICAgY291bnQtLVxuICAgICAgICAgICAgICAgIGNvdW50ZXJTbGlkZS5pbm5lckhUTUwgPSBjb3VudDtcbiAgICAgICAgICAgIH0pXG5cbiAgICAgICAgICAgIHdpbmRvdy5yZW1vdmVFdmVudExpc3RlbmVyKCdyZXNpemUnLCBvblJlc2l6ZSk7XG4gICAgICAgICAgICB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcigncmVzaXplJywgb25SZXNpemUpO1xuICAgICAgICAgICAgZWwucmVtb3ZlRXZlbnRMaXN0ZW5lcignbW91c2Vkb3duJywgb25Nb3VzZURvd24pO1xuICAgICAgICAgICAgZWwucmVtb3ZlRXZlbnRMaXN0ZW5lcigndG91Y2hzdGFydCcsIG9uTW91c2VEb3duKTtcbiAgICAgICAgICAgIGVsLmFkZEV2ZW50TGlzdGVuZXIoJ21vdXNlZG93bicsIG9uTW91c2VEb3duKTtcbiAgICAgICAgICAgIGVsLmFkZEV2ZW50TGlzdGVuZXIoJ3RvdWNoc3RhcnQnLCBvbk1vdXNlRG93bik7XG4gICAgICAgICAgICBlbC5yZW1vdmVFdmVudExpc3RlbmVyKCdtb3VzZW1vdmUnLCBvbk1vdXNlTW92ZSk7XG4gICAgICAgICAgICBlbC5yZW1vdmVFdmVudExpc3RlbmVyKCd0b3VjaG1vdmUnLCBvbk1vdXNlTW92ZSk7XG4gICAgICAgICAgICBlbC5hZGRFdmVudExpc3RlbmVyKCdtb3VzZW1vdmUnLCBvbk1vdXNlTW92ZSk7XG4gICAgICAgICAgICAvLyBlbC5hZGRFdmVudExpc3RlbmVyKCd0b3VjaG1vdmUnLCBvbk1vdXNlTW92ZSk7XG4gICAgICAgICAgICB3aW5kb3cucmVtb3ZlRXZlbnRMaXN0ZW5lcignbW91c2V1cCcsIG9uTW91c2VFbmQpO1xuICAgICAgICAgICAgd2luZG93LnJlbW92ZUV2ZW50TGlzdGVuZXIoJ3RvdWNoZW5kJywgb25Nb3VzZUVuZCk7XG4gICAgICAgICAgICB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcignbW91c2V1cCcsIG9uTW91c2VFbmQpO1xuICAgICAgICAgICAgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoJ3RvdWNoZW5kJywgb25Nb3VzZUVuZCk7XG5cbiAgICAgICAgICAgIGlmIChhdXRvcGxheSkge1xuICAgICAgICAgICAgICAgIHRpbWVySWQgPSBzZXRJbnRlcnZhbCgoKSA9PiB0b2dnbGVJbmRleCgoYWN0aXZlSW5kSW5kZXggKyAxKSAlIGluZGljYXRvcnMubGVuZ3RoKSwgQVVUT1BMQVlfSU5URVJWQUwpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICByZXR1cm4gb2JqXG4gICAgICAgIH0sXG4gICAgICAgIGNvbmZpZzoge1xuICAgICAgICAgICAgZWxlbXNQZXJQYWdlOiB7XG4gICAgICAgICAgICAgICAgLi4ue1xuICAgICAgICAgICAgICAgICAgICAnbGcnOiAxLFxuICAgICAgICAgICAgICAgICAgICAnbWQnOiAxLFxuICAgICAgICAgICAgICAgICAgICAnc20nOiAxLFxuICAgICAgICAgICAgICAgICAgICAneHMnOiAxXG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAuLi4oKGNvbmZpZyAmJiBjb25maWcuZWxlbXNQZXJQYWdlKSB8fCB7fSlcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBtZWRpYToge1xuICAgICAgICAgICAgICAgIC4uLntcbiAgICAgICAgICAgICAgICAgICAgJ2xnJzogMTE2MCxcbiAgICAgICAgICAgICAgICAgICAgJ21kJzogOTIwLFxuICAgICAgICAgICAgICAgICAgICAnc20nOiA3MDBcbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgIC4uLigoY29uZmlnICYmIGNvbmZpZy5tZWRpYSkgfHwge30pXG4gICAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICAgIGJ1aWxkU2xpZGVyOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICBvYmoucmVtb3ZlU2xpZGVyKCk7XG5cblxuICAgICAgICAgICAgdmFyIHdyYXBwZXIgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiZGl2XCIpO1xuICAgICAgICAgICAgd3JhcHBlci5jbGFzc05hbWUgPSAnc2xpZGVyLXdyYXBwZXInO1xuICAgICAgICAgICAgdmFyIGlubmVyID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImRpdlwiKTtcbiAgICAgICAgICAgIGlubmVyLmNsYXNzTmFtZSA9ICdzbGlkZXItaW5uZXInO1xuICAgICAgICAgICAgd3JhcHBlci5hcHBlbmRDaGlsZChpbm5lcik7XG4gICAgICAgICAgICBlbC5hcHBlbmRDaGlsZCh3cmFwcGVyKTtcblxuICAgICAgICAgICAgaWYgKG9iai5jb25maWcuZWxlbXNQZXJQYWdlW21lZGlhU3RlcF0gPj0gaXRlbXMubGVuZ3RoICsgMSkge1xuICAgICAgICAgICAgICAgIGVsLmNsYXNzTGlzdC5hZGQoJ25vdC1lbm91Z2gtZWxlbXMnKTtcbiAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBidWlsZFBhZ2VzKCk7XG4gICAgICAgIH0sXG4gICAgICAgIC8vICAgICBnZXRNZWRpYVN0ZXAoKSB7XG4gICAgICAgIC8vICAgICAvLyB2YXIgd2lkdGggPSB3aW5kb3cuaW5uZXJXaWR0aDtcbiAgICAgICAgLy8gICAgIC8vIHZhciBuZXdTdGVwID0gd2lkdGggPiBtZWRpYUNvbmZpZyAmJiBtZWRpYUNvbmZpZy5sZyAhPT0gdW5kZWZpbmVkID8gbWVkaWFDb25maWcubGcgOiAxMTUwID8gJ2xnJ1xuICAgICAgICAvLyAgICAgLy8gICAgIDogd2lkdGggPiAobWVkaWFDb25maWcgJiYgbWVkaWFDb25maWcubWQgIT09IHVuZGVmaW5lZCA/IG1lZGlhQ29uZmlnLm1kIDogNzY3KSA/ICdtZCdcbiAgICAgICAgLy8gICAgIC8vICAgICAgICAgOiB3aWR0aCA+IChtZWRpYUNvbmZpZyAmJiBtZWRpYUNvbmZpZy5zbSAhPT0gdW5kZWZpbmVkID8gbWVkaWFDb25maWcuc20gOiA2MDApID8gJ3NtJyA6ICd4cyc7XG4gICAgICAgIC8vXG4gICAgICAgIC8vICAgICBpZiAobWVkaWFTdGVwICE9PSBuZXdTdGVwKSB7XG4gICAgICAgIC8vICAgICAgICAgbWVkaWFTdGVwID0gbmV3U3RlcDtcbiAgICAgICAgLy8gICAgICAgICBvYmouYnVpbGRTbGlkZXIoKTtcbiAgICAgICAgLy8gICAgIH1cbiAgICAgICAgLy8gfSxcbiAgICAgICAgcmVtb3ZlU2xpZGVyOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICB2YXIgd3JhcHBlciA9IGVsLnF1ZXJ5U2VsZWN0b3IoJy5zbGlkZXItd3JhcHBlcicpO1xuICAgICAgICAgICAgZWwuY2xhc3NMaXN0LnJlbW92ZSgnbm90LWVub3VnaC1lbGVtcycpXG4gICAgICAgICAgICB3cmFwcGVyICYmIHdyYXBwZXIucmVtb3ZlKCk7XG4gICAgICAgICAgICBpZiAodGltZXJJZCkge1xuICAgICAgICAgICAgICAgIGNsZWFySW50ZXJ2YWwodGltZXJJZCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICAgIHRvZ2dsZTogdG9nZ2xlSW5kZXhcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBidWlsZEluZGljYXRvcnMoKSB7XG4gICAgICAgIHZhciBwcmV2SW5kID0gZWwucXVlcnlTZWxlY3RvcignLnNsaWRlci1pbmRpY2F0b3JzJyk7XG4gICAgICAgIHByZXZJbmQgJiYgcHJldkluZC5yZW1vdmUoKTtcblxuICAgICAgICB2YXIgaW5kaWNhdG9ycyA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xuICAgICAgICBpbmRpY2F0b3JzLmNsYXNzTGlzdC5hZGQoJ3NsaWRlci1pbmRpY2F0b3JzJylcbiAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBNYXRoLmNlaWwoaXRlbXMubGVuZ3RoIC8gZ2V0SXRlbXNRdWFudGl0eSgpKTsgaSsrKSB7XG4gICAgICAgICAgICBsZXQgaW5kaWNhdG9yID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XG4gICAgICAgICAgICBpbmRpY2F0b3IuY2xhc3NMaXN0LmFkZCgnc2xpZGVyLWluZGljYXRvcicpO1xuICAgICAgICAgICAgaWYgKGkgPT09IGFjdGl2ZUluZEluZGV4KSB7XG4gICAgICAgICAgICAgICAgaW5kaWNhdG9yLmNsYXNzTGlzdC5hZGQoJ2FjdGl2ZScpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaW5kaWNhdG9yLnNldEF0dHJpYnV0ZSgnaW5kZXgnLCBpKVxuICAgICAgICAgICAgaW5kaWNhdG9yLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgIHRvZ2dsZUluZGV4KGkpXG4gICAgICAgICAgICB9KVxuICAgICAgICAgICAgaW5kaWNhdG9ycy5hcHBlbmRDaGlsZChpbmRpY2F0b3IpO1xuICAgICAgICB9XG5cbiAgICAgICAgdmFyIHdyYXBwZXIgPSBlbC5xdWVyeVNlbGVjdG9yKCcuc2xpZGVyLXdyYXBwZXInKVxuICAgICAgICB3cmFwcGVyLmFwcGVuZENoaWxkKGluZGljYXRvcnMpO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIGJ1aWxkUGFnZXMoc3RlcCkge1xuICAgICAgICBzdGVwID0gc3RlcCB8fCAxO1xuICAgICAgICB2YXIgcGFnZVByZXYgPSBidWlsZFBhZ2Uob2JqLmFjdGl2ZUluZGV4ICsgaXRlbXMubGVuZ3RoIC0gZ2V0SXRlbXNRdWFudGl0eSgpICogc3RlcCk7XG4gICAgICAgIHZhciBwYWdlQ3VycmVudCA9IGJ1aWxkUGFnZShvYmouYWN0aXZlSW5kZXgpXG4gICAgICAgIHZhciBwYWdlTmV4dCA9IGJ1aWxkUGFnZShvYmouYWN0aXZlSW5kZXggKyBnZXRJdGVtc1F1YW50aXR5KCkgKiBzdGVwKTtcbiAgICAgICAgdmFyIGlubmVyID0gZWwucXVlcnlTZWxlY3RvcignLnNsaWRlci1pbm5lcicpO1xuICAgICAgICBpZiAoZ2V0SXRlbXNRdWFudGl0eSgpIDwgaXRlbXMubGVuZ3RoKSB7XG4gICAgICAgICAgICBidWlsZEluZGljYXRvcnMoKTtcbiAgICAgICAgICAgIGlmICghZWwucXVlcnlTZWxlY3RvcignLnNsaWRlci1pbmRpY2F0b3IuYWN0aXZlJykpIHtcbiAgICAgICAgICAgICAgICAvLyB0b2dnbGVJbmRleCgwKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBpbm5lci5pbm5lckhUTUwgPSAnJztcbiAgICAgICAgaW5uZXIuYXBwZW5kQ2hpbGQocGFnZVByZXYpXG4gICAgICAgIGlubmVyLmFwcGVuZENoaWxkKHBhZ2VDdXJyZW50KVxuICAgICAgICBpbm5lci5hcHBlbmRDaGlsZChwYWdlTmV4dClcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBidWlsZFBhZ2UoaW5kZXgpIHtcbiAgICAgICAgdmFyIHBhZ2UgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiZGl2XCIpXG4gICAgICAgIHBhZ2UuY2xhc3NMaXN0LmFkZCgnc2xpZGVyLXBhZ2UnKVxuICAgICAgICBmb3IgKGxldCBpID0gaW5kZXg7IGkgPCAoaW5kZXggKyBnZXRJdGVtc1F1YW50aXR5KCkpOyBpKyspIHtcbiAgICAgICAgICAgIGxldCBpdGVtID0gaXRlbXNbaSAlIGl0ZW1zLmxlbmd0aF07XG4gICAgICAgICAgICBsZXQgbmV3SXRlbSA9IGl0ZW0uY2xvbmVOb2RlKHRydWUpO1xuICAgICAgICAgICAgcGFnZS5hcHBlbmRDaGlsZChuZXdJdGVtKVxuICAgICAgICB9XG4gICAgICAgIHJldHVybiBwYWdlO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIHRvZ2dsZUluZGV4KGluZGV4KSB7XG4gICAgICAgIHZhciBpbmRBY3RpdmUgPSBlbC5xdWVyeVNlbGVjdG9yKCcuc2xpZGVyLWluZGljYXRvci5hY3RpdmUnKVxuICAgICAgICB2YXIgaW5kaWNhdG9ycyA9IGVsLnF1ZXJ5U2VsZWN0b3JBbGwoJy5zbGlkZXItaW5kaWNhdG9yJyk7XG4gICAgICAgIGlmICghaW5kaWNhdG9yc1tpbmRleF0pIHtcbiAgICAgICAgICAgIHJldHVyblxuICAgICAgICB9XG5cbiAgICAgICAgbGVmdEFycm93LmNsYXNzTGlzdC5yZW1vdmUoJ2Fycm93LWRpc2FibGVkJyk7XG4gICAgICAgIHJpZ2h0QXJyb3cuY2xhc3NMaXN0LnJlbW92ZSgnYXJyb3ctZGlzYWJsZWQnKTtcblxuICAgICAgICBpZiAoaW5kZXggPT09IDApIHtcbiAgICAgICAgICAgIGxlZnRBcnJvdy5jbGFzc0xpc3QuYWRkKCdhcnJvdy1kaXNhYmxlZCcpO1xuICAgICAgICB9XG5cbiAgICAgICAgaWYgKGluZGV4ID09PSBpbmRpY2F0b3JzLmxlbmd0aCAtIDEpIHtcbiAgICAgICAgICAgIHJpZ2h0QXJyb3cuY2xhc3NMaXN0LmFkZCgnYXJyb3ctZGlzYWJsZWQnKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGluZEFjdGl2ZSAmJiBpbmRBY3RpdmUuY2xhc3NMaXN0LnJlbW92ZSgnYWN0aXZlJylcbiAgICAgICAgaW5kaWNhdG9yc1tpbmRleF0gJiYgaW5kaWNhdG9yc1tpbmRleF0uY2xhc3NMaXN0LmFkZCgnYWN0aXZlJylcbiAgICAgICAgaWYgKGluZGV4ID4gYWN0aXZlSW5kSW5kZXgpIHtcbiAgICAgICAgICAgIGluZGV4IC0gYWN0aXZlSW5kSW5kZXggPiAxICYmIGJ1aWxkUGFnZXMoaW5kZXggLSBhY3RpdmVJbmRJbmRleClcbiAgICAgICAgICAgIG9iai5uZXh0KCk7XG4gICAgICAgIH0gZWxzZSBpZiAoaW5kZXggPCBhY3RpdmVJbmRJbmRleCkge1xuICAgICAgICAgICAgYWN0aXZlSW5kSW5kZXggLSBpbmRleCA+IDEgJiYgYnVpbGRQYWdlcyhhY3RpdmVJbmRJbmRleCAtIGluZGV4KVxuICAgICAgICAgICAgb2JqLnByZXYoKVxuICAgICAgICB9XG4gICAgICAgIGFjdGl2ZUluZEluZGV4ID0gaW5kZXhcbiAgICAgICAgLy8gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmN1cnJlbnQnKS50ZXh0Q29udGVudCA9IGFjdGl2ZUluZEluZGV4ICsgMTtcbiAgICB9XG5cbiAgICBvYmoucHJldiA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIHdyYXBwZXIgPSBlbC5xdWVyeVNlbGVjdG9yKCcuc2xpZGVyLXdyYXBwZXInKVxuICAgICAgICB3cmFwcGVyLmNsYXNzTGlzdC5hZGQoJ3ByZXYnKTtcbiAgICAgICAgc2V0VGltZW91dChmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICB3cmFwcGVyLmNsYXNzTGlzdC5yZW1vdmUoJ3ByZXYnKVxuICAgICAgICAgICAgb2JqLmFjdGl2ZUluZGV4ID0gKG9iai5hY3RpdmVJbmRleCAtIGdldEl0ZW1zUXVhbnRpdHkoKSArIGl0ZW1zLmxlbmd0aCkgJSBpdGVtcy5sZW5ndGg7XG4gICAgICAgICAgICBidWlsZFBhZ2VzKClcbiAgICAgICAgfSwgMzAwKTtcbiAgICB9XG5cbiAgICBvYmoubmV4dCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIHdyYXBwZXIgPSBlbC5xdWVyeVNlbGVjdG9yKCcuc2xpZGVyLXdyYXBwZXInKVxuICAgICAgICB3cmFwcGVyLmNsYXNzTGlzdC5hZGQoJ25leHQnKTtcbiAgICAgICAgc2V0VGltZW91dChmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICB3cmFwcGVyLmNsYXNzTGlzdC5yZW1vdmUoJ25leHQnKVxuICAgICAgICAgICAgb2JqLmFjdGl2ZUluZGV4ID0gKG9iai5hY3RpdmVJbmRleCArIGdldEl0ZW1zUXVhbnRpdHkoKSArIGl0ZW1zLmxlbmd0aCkgJSBpdGVtcy5sZW5ndGg7XG4gICAgICAgICAgICBidWlsZFBhZ2VzKClcbiAgICAgICAgfSwgMzAwKTtcbiAgICB9XG4gICAgcmV0dXJuIG9iai5pbml0KCk7XG59XG4iLCIiXX0=
